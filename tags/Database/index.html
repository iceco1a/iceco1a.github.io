<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
<title>Tag: Database - iceco1a</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    <meta property="og:type" content="website">
<meta property="og:title" content="iceco1a">
<meta property="og:url" content="http://iceco1a.github.io/tags/Database/index.html">
<meta property="og:site_name" content="iceco1a">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iceco1a">





<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/vs.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    

    
    
    
    

    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-2-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.svg" alt="iceco1a" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item" href="/">Home</a>
                
                <a class="navbar-item" href="/archives">Archives</a>
                
                <a class="navbar-item" href="/categories">Categories</a>
                
                <a class="navbar-item" href="/tags">Tags</a>
                
                <a class="navbar-item" href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="Download on GitHub" href="http://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-8-widescreen has-order-2 column-main"><div class="card">
    <div class="card-content">
        <nav class="breadcrumb" aria-label="breadcrumbs">
        <ul>
            <li><a href="/tags">Tags</a></li>
            <li class="is-active"><a href="#" aria-current="page">Database</a></li>
        </ul>
        </nav>
    </div>
</div>

    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-01-23T16:00:00.000Z">2019-01-24</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    an hour read (About 10824 words)
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/01/24/MySQL基础/">MySQL基础</a>
            
        </h1>
        <div class="content">
            <h3 id="关系型数据库基本概念"><a href="#关系型数据库基本概念" class="headerlink" title="关系型数据库基本概念"></a>关系型数据库基本概念</h3><p>严格来说，数据库(Database)仅仅是存放用户数据的地方。当用户访问、操作数据库中的数据时，就需要数据库管理系统的帮助。数据库管理系统的全称是Database Management System,简称DBMS。习惯上常常把数据库和数据库管理系统笼统地称为数据库,通常所说的数据库既包括存储用户数据的部分，也包括管理数据库的管理系统。</p>
<p>DBMS是所有数据的知识库，它负责管理数据的存储、安全、一致性、并发、恢复和访问等操作。DBMS有一个数据字典(有时也被称为系统表)，用于存储它拥有的每个事务的相关信息，例如名字、结构、位置和类型，这种关于数据的数据也被称为元数据(metadata)。</p>
<p>在数据库发展历史中，按时间顺序主要出现了如下几种类型的数据库系统。</p>
<ul>
<li>网状型数据库</li>
<li>层次型数据库</li>
<li>关系数据库</li>
<li>面向对象数据库</li>
</ul>
<p>在上面4种数据库系统中，关系数据库是理论最成熟、应用最广泛的数据库。从20世纪70年代末开始，关系数据库理论逐渐成熟，随之涌现出大量商用的关系数据库。关系数据库理论经过30多年的发展已经相当完善，在大量数据的查找、排序操作.上非常成熟且快速,并对数据库系统的并发、隔离有非常完善的解决方案。</p>
<p>面向对象数据库则是由面向对象编程语言催生的新型数据库，目前有些数据库系统如Oracle11g等开始增加面向对象特性，但面向对象数据库还没有大规模地商业应用。</p>
<p>对于关系数据库而言,最基本的数据存储单元就是数据表，因此可以简单地把数据库想象成大量数据表的集合(当然，数据库绝不仅由数据表组成)。</p>
<p>数据表是存储数据的逻辑单元，可以把数据表想象成由行和列组成的表格,其中每一行也被称为一条<strong>记录</strong>，每一列也被称为一个<strong>字段</strong>。为数据库建表时，通常需要指定该表包含多少列，每列的数据类型信息,无须指定该数据表包含多少行一因为 数据库表的行是动态改变的,每行用于保存一条用户数据。除此之外，还应该为每个数据表指定一个特殊列，该特殊列的值可以唯一地标识此行的记录，则该特殊列被称为主键列。</p>
<hr>
<h3 id="MySQL基本命令"><a href="#MySQL基本命令" class="headerlink" title="MySQL基本命令"></a>MySQL基本命令</h3><p>MySQL数据库的一个实例(Server Instance)可以同时包含多个数据库，MySQL 使用如下命令来查看当前实例下包含多少个数据库:</p>
<p> <code>show database;</code></p>
<p> MySQL默认以分号作为每条命令的结束符，所以在每条MySQL命令结束后都应该输一个英文分号(;).</p>
<p>如果用户需要创建新的数据库，则可以使用如下命令:<br><code>create database [IF NOT EXISTS] 数据库名;</code></p>
<p>如果用户需要删除指定数据库，则可以使用如下命令:<br><code>drop database 数据库名;</code></p>
<p>建立了数据库之后，如果想操作该数据库(例如为该数据库建表，在该数据库中执行查询等操作),则需要进入该数据库。进入指定数据库可以使用如下命令:<br><code>use 数据库名;</code></p>
<p>进入指定数据库后，如果需要查询该数据库下包含多少个数据表，则可以使用如下命令:<br><code>show tables;</code></p>
<p>如果想查看指定数据表的表结构(查看该表有多少列，每列的数据类型等信息)，则可以使用如下命令:<br><code>desc表名</code></p>
<p> MySQL基本登录命令<br> <code>mysql -P 密码 -u 用户名 -h 主机名 --default-character-set=utf8</code></p>
<p> MySQL数据库通常支持如下两种存储机制。</p>
<ul>
<li>MyISAM:这是MySQL早期默认的存储机制，对事务支持不够好。</li>
<li>InnoDB: InnoDB 提供事务安全的存储机制。InnoDB 通过建立行级锁来保证事务完整性，并以Oracle风格的共享锁来处理Select语句。系统默认启动InnoDB存储机制,如果不想使用InnoDB表，则可以使用skip-innodb选项。</li>
</ul>
<p>对比两种存储机制，不难发现InnoDB比MyISAM多了事务支持的功能，而事务支持是Java EE最重要的特性，因此通常推荐使用InnoDB存储机制。如果使用5.0以上版本的MySQL数据库系统,通常无须指定数据表的存储机制，因为系统默认使用InnoDB存储机制。如果需要在建表时显式指定存储机制，则可在标准建表语法的后面添加下面任意一句。</p>
<ul>
<li>ENGINE=MyISAM  强制使用MyISAM存储机制。</li>
<li>ENGINE=InnoDB  强制使用InnoDB存储机制。</li>
</ul>
<hr>
<h3 id="SQL语句基础"><a href="#SQL语句基础" class="headerlink" title="SQL语句基础"></a>SQL语句基础</h3><p>SQL的全称是Structured Query Language,也就是结构化查询语言。SQL是操作和检索关系数据库的标准语言，标准的SQL语句可用于操作任何关系数据库。</p>
<p>使用SQL语句，程序员和数据库管理员(DBA) 可以完成如下任务。</p>
<ul>
<li>在数据库中检索信息。</li>
<li>对数据库的信息进行更新。</li>
<li>改变数据库的结构。</li>
<li>更改系统的安全设置。</li>
<li>增加或回收用户对数据库、表的许可权限。</li>
</ul>
<p>在上面5个任务中，一般程序员可以管理前3个任务，后面2个任务通常由DBA来完成。</p>
<p>标准的SQL语句通常可分为如下几种类型。</p>
<ul>
<li>查询语句:主要由select关键字完成，查询语句是SQL语句中最复杂、功能最丰富的语句。</li>
<li>DML(Data Manipulation Language,数据操作语言)语句:主要由insert、update 和delete三个关键字完成。</li>
<li>DDL(Data Definition Language, 数据定义语言)语句:主要由create、alter、 drop 和truncate四个关键字完成。</li>
<li>DCL(Data Control Language,数据控制语言)语句:主要由grant和revoke两个关键字完成。</li>
<li>事务控制语句:主要由commit、rollback 和savepoint三个关键字完成。</li>
</ul>
<p>SQL语句的关键字不区分大小写，也就是说，create和CREATE的作用完全一样。 在上面5种SQL语句中，DCL语句用于为数据库用户授权，或者回收指定用户的权限，通常无须程序员操作</p>
<p>在SQL命令中也可能需要使用标识符，标识符可用于定义表名、列名，也可用于定义变量等。这些标识符的命名规则如下。</p>
<ul>
<li>标识符通常必须以字母开头。</li>
<li>标识符包括字母、数字和三个特殊字符(#_ $)。</li>
<li>不要使用当前数据库系统的关键字、保留字，通常建议使用多个单词连缀而成，单词之间以_分隔。</li>
<li>同一个模式下的对象不应该同名，这里的模式指的是外模式。</li>
</ul>
<p>truncate是一个特殊的DDL语句，truncate 在很多数据库中都被归类为DDL，它相当于先删除指定的数据表,然后再重建该数据表。如果使用MySQL的普通存储机制, truncate确实是这样的。但如果使用InnoDB存储机制,则比较复杂,在MySQL5.0.3之前, truncate和delete完全一样;在5.0.3之后，truncate table比delete效率高，但如果该表被外键约束所参照，则依然被映射成delete操作。当使用快速truncate时，该操作会重设自动增长计数器。在5.0.13之后，快速truncate总是可用，即比delete性能要好。</p>
<h4 id="DDL语句"><a href="#DDL语句" class="headerlink" title="DDL语句"></a>DDL语句</h4><p>DDL语句是操作数据库对象的语句，包括创建(create)、删除(drop)和修改(alter) 数据库对象。最基本的数据库对象是数据表，数据表是存储数据的逻辑单元。但数据库里绝不仅包括数据表，数据库里可包含如表所示的几种常见的数据库对象。</p>
<table>
<thead>
<tr>
<th>对象名称</th>
<th>对应关键字</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>表</td>
<td>table</td>
<td>表是存储数据的逻辑单元，以行和列的形式存在;列就是字段，行就是记录</td>
</tr>
<tr>
<td>数据字典</td>
<td></td>
<td>就是系统表，存放数据库相关信息的表。系统表里的数据通常由数据库系统护，程序员通常不应该手动删除修改系统表数据</td>
</tr>
<tr>
<td>约束</td>
<td>constraint</td>
<td>执行数据校验的规则，用于保证数据完整性的规则</td>
</tr>
<tr>
<td>视图</td>
<td>view</td>
<td>一个或者多个数据表里数据的逻辑显示。视图并不存储数据</td>
</tr>
<tr>
<td>索引</td>
<td>index</td>
<td>用于提高查询性能，相当于书的目录</td>
</tr>
<tr>
<td>函数</td>
<td>function</td>
<td>用于完成一次特定的计算，具有一个返回值</td>
</tr>
<tr>
<td>存储过程</td>
<td>procedure</td>
<td>用于完成一次完整的业务处理，没有返回值，但可通过传出参数将多个值传给调用环境</td>
</tr>
<tr>
<td>触发器</td>
<td>trigger</td>
<td>相当于一个事件监听器，当数据库发生特定事件后，触发器被触发，完成相应的处理</td>
</tr>
</tbody>
</table>
<h5 id="创建表的语法"><a href="#创建表的语法" class="headerlink" title="创建表的语法"></a>创建表的语法</h5><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> [模式名.]表名</span><br><span class="line">(</span><br><span class="line">    <span class="hljs-comment">#可以有多个列定义</span></span><br><span class="line">    columnName1 datatype [<span class="hljs-keyword">default</span> expr])</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>下表为MySQL支持的数据类型</p>
<table>
<thead>
<tr>
<th style="text-align:center">列类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">tinyint/smallint/mediumint/int(integer)/bigint</td>
<td>1字节/2字节/3字节/4字节/8字节整数，又可分为有符号和无符号两种。这些整数类型的区别仅仅是表数范围不同</td>
</tr>
<tr>
<td style="text-align:center">float/double</td>
<td>单精度、双精度浮点类型</td>
</tr>
<tr>
<td style="text-align:center">decimal(dec)</td>
<td>精确小数类型，相对于float和double不会产生精度丟失的问题</td>
</tr>
<tr>
<td style="text-align:center">date</td>
<td>日期类型,不能保存时间。把java.util.Date对象保存进date列时，时间部分将会丢失</td>
</tr>
<tr>
<td style="text-align:center">time</td>
<td>时间类型,不能保存日期。把java util.Date对象保存进time列时，日期部分将会丢失</td>
</tr>
<tr>
<td style="text-align:center">datetime</td>
<td>日期、时间类型</td>
</tr>
<tr>
<td style="text-align:center">timestamp</td>
<td>时间截类型</td>
</tr>
<tr>
<td style="text-align:center">year</td>
<td>年类型，仅仅保存时间的年份</td>
</tr>
<tr>
<td style="text-align:center">char</td>
<td>定长字符串类型</td>
</tr>
<tr>
<td style="text-align:center">varchar</td>
<td>可变长度字符串类型</td>
</tr>
<tr>
<td style="text-align:center">binary</td>
<td>定长二进制字符串类型，它以二进制形式保存字符串</td>
</tr>
<tr>
<td style="text-align:center">varbinary</td>
<td>可变长度的二进制字符串类型，它以二进制形式保存字符串</td>
</tr>
<tr>
<td style="text-align:center">tinyblob/blob/mediumblob/longblob</td>
<td>1字节/2字节/3字节/4字节的二进制大对象,可用于存储图片、音乐等二进制数据，分别可存储: 255B/64KB/6MB/4GB 的大小</td>
</tr>
<tr>
<td style="text-align:center">tinytext/text/mediumtex/longtext</td>
<td>1字节2字节/3字节/4字节的文本对象，可用于存储超长长度的字符串，分别可存储: 255B/64KB/16MB/4GB大小的文本</td>
</tr>
<tr>
<td style="text-align:center">enum(‘valuel’,valu2…)</td>
<td>枚举类型，该列的值只能是enum后括号里多个值的其中之一</td>
</tr>
<tr>
<td style="text-align:center">set(‘valuel’,’value2’…)</td>
<td>集合类型，该列的值可以是set后括号里多个值的其中几个</td>
</tr>
</tbody>
</table>
<p>一例：<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-string">`test_first`</span> (</span><br><span class="line">  <span class="hljs-string">`test_id`</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  <span class="hljs-string">`test_price`</span> <span class="hljs-built_in">decimal</span>(<span class="hljs-number">10</span>,<span class="hljs-number">0</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  <span class="hljs-string">`test_name`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'xxxx'</span>,</span><br><span class="line">  <span class="hljs-string">`test_desc`</span> <span class="hljs-built_in">text</span>,</span><br><span class="line">  <span class="hljs-string">`test_img`</span> <span class="hljs-built_in">blob</span>,</span><br><span class="line">  <span class="hljs-string">`test_date`</span> datetime <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span></span><br><span class="line">) <span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">CHARSET</span>=utf8</span><br></pre></td></tr></table></figure></p>
<p>上面是比较常见的建表语句，这种建表语句只是创建一个空表,该表里没有任何数据。如果使用子查询建表语句，则可以在建表的同时插入数据。子查询建表语句的语法如下:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> [模式名.]表名 [<span class="hljs-keyword">column</span>[,column...]]</span><br><span class="line"><span class="hljs-keyword">as</span> subquery;</span><br></pre></td></tr></table></figure></p>
<p>上面语法中新表的字段列表必须与子查询中的字段列表数量匹配，创建新表时的字段列表可以省略，如果省略了该字段列表，则新表的列名与选择结果完全相同。下面语句使用子查询来建表。<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># 创建hehe数据表，该数据表和user_ inf完全相同，数据也完全相同</span></span><br><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> hehe</span><br><span class="line"><span class="hljs-keyword">as</span></span><br><span class="line"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> user_ inf;</span><br></pre></td></tr></table></figure></p>
<h5 id="修改变结构语法"><a href="#修改变结构语法" class="headerlink" title="修改变结构语法"></a>修改变结构语法</h5><p>修改表结构使用alter table,修改表结构包括增加列定义、修改列定义、删除列、重命名列等操作。增加列定义的语法如下:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> 表名</span><br><span class="line"><span class="hljs-keyword">add</span></span><br><span class="line"><span class="hljs-comment">#可以有多个列定义</span></span><br><span class="line"><span class="hljs-keyword">column</span> name_l datatype [<span class="hljs-keyword">default</span> expr]，</span><br><span class="line">......</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>一例：<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># 为hehe数据表增加一个hehe id字段，该字段的类型为int</span></span><br><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> hehe</span><br><span class="line"><span class="hljs-keyword">add</span> hehe_id <span class="hljs-built_in">int</span>;</span><br><span class="line"><span class="hljs-comment">#量为hehe数据表增加aaa、bbb字段，两个字段的类型都为varchar(255)</span></span><br><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> hehe</span><br><span class="line"><span class="hljs-keyword">add</span></span><br><span class="line">aaa <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>) <span class="hljs-keyword">default</span> <span class="hljs-string">'xxx'</span>,</span><br><span class="line">bbb <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>增加字段时需要注意:如果数据表中已有数据记录，除非给新增的列指定了默认值,否则新增的数据列不可指定非空约束，因为那些已有的记录在新增列上肯定是空(实际上，修改表结构很容易失败，只要新增的约束与已有数据冲突，修改就会失败)。</p>
<p>修改列的语法如下<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> 表名</span><br><span class="line"><span class="hljs-keyword">modify</span> <span class="hljs-keyword">column</span> <span class="hljs-keyword">name</span> datatype [<span class="hljs-keyword">default</span> expr] [<span class="hljs-keyword">first</span>|<span class="hljs-keyword">after</span> <span class="hljs-keyword">col</span> <span class="hljs-keyword">name</span> ] ;</span><br></pre></td></tr></table></figure></p>
<p>一例<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#将hehe表的hehe id列修改成varchar (255)类型</span></span><br><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> hehe</span><br><span class="line"><span class="hljs-keyword">modify</span> hehe_id <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>);</span><br><span class="line">单将hehe表的bbb列修改成int类型</span><br><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> hehe</span><br><span class="line"><span class="hljs-keyword">modify</span> bbb <span class="hljs-built_in">int</span>;</span><br></pre></td></tr></table></figure></p>
<p>虽然MySQL的一个modify命令不支持一次修改多个列定义,但其他数据库如Oracle支持一个modify命令修改多个列定义,一个modify命令修改多个列定义的语法和一个add命令增加多个列定义的语法非常相似，也需要使用圆括号把多个列定义括起来。如果需要让MySQL支持-次修改多个列定义，则可在alter table后使用多个modify命令。add新增的列名必须是原表中不存在的，而modify修改的列名必须是原表中已存在的。</p>
<p>如果数据表里已有数据记录，则修改列定义非常容易失败，因为有可能修改的列定义规则与原有数据记录不符合。如果修改数据列的默认值，则只会对以后的插入操作有作用，对以前已经存在的数不会有任何影响。<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> 表名</span><br><span class="line"><span class="hljs-keyword">drop</span> <span class="hljs-keyword">column</span> <span class="hljs-keyword">name</span></span><br></pre></td></tr></table></figure></p>
<p>重命名数据表的语法格式如下:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> 表名</span><br><span class="line"><span class="hljs-keyword">rename</span> <span class="hljs-keyword">to</span> 新表名</span><br></pre></td></tr></table></figure></p>
<p>MySQL为alter table提供了change 选项，该选项可以改变列名。change 选项的语法如下:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> 表名</span><br><span class="line"><span class="hljs-keyword">change</span> o1d <span class="hljs-keyword">column</span> <span class="hljs-keyword">name</span> new_ <span class="hljs-keyword">column</span> <span class="hljs-keyword">name</span> <span class="hljs-keyword">type</span> [<span class="hljs-keyword">default</span> exprl [firstlafter <span class="hljs-keyword">col</span> <span class="hljs-keyword">name</span>]</span><br></pre></td></tr></table></figure></p>
<p>对比change和modify两个选项,不难发现: change选项比modify选项多了一个列名，因为change选项可以改变列名，所以它需要两个列名。一般而言，如果不需要改变列名，使用alter table的modify选项即可，只有当需要修改列名时才会使用change选项。<br>如下语句所示:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#将wawa数据表的bbb字段重命名为ddd</span></span><br><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> wawa</span><br><span class="line"><span class="hljs-keyword">change</span> bbb ddd <span class="hljs-built_in">int</span>;</span><br></pre></td></tr></table></figure></p>
<h5 id="删除表的语法"><a href="#删除表的语法" class="headerlink" title="删除表的语法"></a>删除表的语法</h5><p>删除表的语法比较简单<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">drop</span> <span class="hljs-keyword">table</span> 表名</span><br></pre></td></tr></table></figure></p>
<p>删除数据表的效果如下：</p>
<ul>
<li>表结构被删除,表对象不再存在。</li>
<li>表里的所有数据也被删除。</li>
<li>该表所有相关的索引、约束也被删除</li>
</ul>
<h5 id="truncate-表"><a href="#truncate-表" class="headerlink" title="truncate 表"></a>truncate 表</h5><p>对于大部分数据库而言,truncate都被当成DDL处理,truncate被称为“截断”某个表。它的作用是<strong>删除该表里的全部数据,但保留表结构</strong>。相对于DML里的delete命令而言, truncate的速度要快得多,而且truncate不像delete可以删除指定的记录, truncate只能一次性删除整个表的全部记录。<br>truncate命令的语法如下:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">truncate</span> 表名</span><br></pre></td></tr></table></figure></p>
<p>MySQL对truncate的处理比较特殊————如果使用非InnoDB存储机制, truncate比delete速度要快;如果使用 InnoDB存储机制,在 MySQL5.0.3之前,truncate和delete完全一样,在5.0.3之后, truncate table比delete效率高,但如果该表被外键约束所参照, truncate又变为delete操作。在5.0.13之后,快速truncate总是可用,即比delete性能要好。</p>
<h4 id="数据库约束"><a href="#数据库约束" class="headerlink" title="数据库约束"></a>数据库约束</h4><p>前面创建的数据表仅仅指定了一些列定义,这仅仅是数据表的基本功能。除此之外,所有的关系数据库都支持对数据表使用约束,通过约束可以更好地保证数据表里数据的完整性。约束是在表上强制执行的数据校验规则,约束主要用于保证数据库里数据的完整性。除此之外,当表中数据存在相互依赖性时,可以保护相关的数据不被删除。</p>
<p>大部分数据库支持下面5种完整性约束。</p>
<ul>
<li>NOT NULL:非空约束,指定某列不能为空。</li>
<li>UNIQUE:唯一约束,指定某列或者几列组合不能重复。</li>
<li>PRIMARY KEY:主键,指定该列的值可以唯一地标识该条记录。   </li>
<li>FOREIGN KEY:外键,指定该行记录从属于主表中的一条记录,主要用于保证参照完整性。</li>
<li>CHECK:检查,指定一个布尔表达式,用于指定对应列的值必须满足该表达式     </li>
</ul>
<p>虽然大部分数据库都支持上面5种约束,但MySQL不支持CHECK约束,虽然MySQL的SOL语句也可以使用CHECK约束,但这个CHECK约束不会有任何作用。    </p>
<p>虽然约束的作用只是用于保证数据表里数据的完整性,但约束也是数据库对象,并被存储在系统表中,也拥有自己的名字。根据约束对数据列的限制,约束分为如下两类:</p>
<ul>
<li>单列约束:每个约束只约束一列。</li>
<li>多列约束:每个约束可以约束多个数据列。</li>
</ul>
<p>为数据表指定约束有如下两个时机。</p>
<ul>
<li>建表的同时为相应的数据列指定约束。</li>
<li>建表后创建,以修改表的方式来增加约束。  </li>
</ul>
<p>大部分约束都可以采用列级约束语法或者表级约束语法。下面依次介绍5种约束的建立和删除(约束通常无法修改)。</p>
<blockquote>
<p>MySQL使用information schema数据库里的TABLE CONSTRAINTS表来保存该数据库实例中所有的约束信息,用户可以通过查询TABLE_CONSTRAINTS表来获取该数据库的约束信息。</p>
</blockquote>
<h5 id="NOT-NULL约束"><a href="#NOT-NULL约束" class="headerlink" title="NOT NULL约束"></a>NOT NULL约束</h5><p>非空约束用于确保指定列不允许为空，非空约束是比较特殊的约束，它只能作为列级约束使用，只能使用列级约束语法定义。这里要介绍一下SQL中的null值，SQL中的null不区分大小写。SQL中的null具有如下特征。</p>
<ul>
<li>所有数据类型的值都可以是null, 包括int、 float、boolean等数据类型。</li>
<li>与Java类似的是，空字符串不等于null, 0也不等于null。<br>如果需要在建表时为指定列指定非空约束，只要在列定义后增加not null即可。</li>
</ul>
<p>建表语句如下:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> hehe</span><br><span class="line">(</span><br><span class="line">  <span class="hljs-comment">#建立了非空约束，这意味着hehe_id不可以为null</span></span><br><span class="line">  hehe <span class="hljs-keyword">id</span> <span class="hljs-built_in">int</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span>,</span><br><span class="line">  <span class="hljs-comment"># MySQL的非空约束不能指定名字</span></span><br><span class="line">  hehe <span class="hljs-keyword">name</span> <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>) <span class="hljs-keyword">default</span> <span class="hljs-string">'xyz'</span> <span class="hljs-keyword">not</span> nul1 ,</span><br><span class="line">  <span class="hljs-comment">#下面列可以为空，默认就是可以为空</span></span><br><span class="line">  hehe gender <span class="hljs-built_in">varchar</span> (<span class="hljs-number">2</span>) nul1</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>除此之外，也可以在使用alter table修改表时增加或者删除非空约束，SQL 命令如下:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#增加非空约束</span></span><br><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> hehe</span><br><span class="line"><span class="hljs-keyword">modify</span> hehe gender <span class="hljs-built_in">varchar</span> (<span class="hljs-number">2</span>) <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span></span><br><span class="line"><span class="hljs-comment">#取消非空约束</span></span><br><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> hehe</span><br><span class="line"><span class="hljs-keyword">modify</span> hehe <span class="hljs-keyword">name</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">2</span>) <span class="hljs-literal">null</span>;</span><br><span class="line"><span class="hljs-comment">#取消非空约束，并指定默认值</span></span><br><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> hehe</span><br><span class="line"><span class="hljs-keyword">modify</span> hehe <span class="hljs-keyword">name</span> <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>) <span class="hljs-keyword">default</span> ‘abc<span class="hljs-string">' null;</span></span><br></pre></td></tr></table></figure></p>
<h5 id="UNIQUE约束"><a href="#UNIQUE约束" class="headerlink" title="UNIQUE约束"></a>UNIQUE约束</h5><p>唯一约束用于保证指定列或指定列组合不允许出现重复值。虽然唯一约束的列不可以出现重复值，但可以出现多个null值(因为在数据库中null不等于null)。</p>
<p>同一个表内可建多个唯一约束， 唯一约束也可由多列组合而成。<code>当为某列创建唯一约束时, MySQL会为该列相应地创建唯一索引。</code> 如果不给唯一约束起名，该唯一约束默认与列名相同。</p>
<p>唯一约束既可以使用列级约束语法建立,也可以使用表级约束语法建立。如果需要为多列建组合约束，或者需要为唯一约束指定约束名，则只能用表级约束语法。</p>
<p>当建立唯一约束时，MySQL 在唯一约束所在列或列组合上建立对应的唯一索引。</p>
<p>使用列级约束语法建立唯一约束非常简单，只要简单地在列定义后增加unique关键字即可。SQL语句如下:</p>
<figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#建表时创建唯一约束，使用列级约束语法建立约束</span></span><br><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> unique_test</span><br><span class="line">(</span><br><span class="line">   <span class="hljs-comment">#建立了非空约束，这意味着test_id不可以为null</span></span><br><span class="line">   test_id <span class="hljs-built_in">int</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span>, </span><br><span class="line">   <span class="hljs-comment">#unique就是唯一约束，使用列级约束语法建立唯一约束</span></span><br><span class="line">   test_name <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>) <span class="hljs-keyword">unique</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>如果需要为多列组合建立唯一约束,或者想自行指定约束名，则需要使用表级约束语法。<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[constraint 约束名]约束定义</span><br></pre></td></tr></table></figure></p>
<p>上面的表级约束语法格式既可放在create table语句中与列定义并列，也可放在alter table语句中使用add关键字来添加约束。<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#建表时创建唯约束，使用表级约束语法建立约束</span></span><br><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> unique_test2</span><br><span class="line">(</span><br><span class="line">     <span class="hljs-comment">#建立了非空约束，这意味着test_id不可以为null</span></span><br><span class="line">     test_id <span class="hljs-built_in">int</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span>,</span><br><span class="line">     test_name <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>) ,</span><br><span class="line">     test_pass <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>) ,</span><br><span class="line">     <span class="hljs-comment">#使用表级约束语法建立唯一约束</span></span><br><span class="line">     <span class="hljs-keyword">unique</span> (test_name)，</span><br><span class="line">     <span class="hljs-comment">#使用表级约束语法建立唯一约束，而且指定约束名</span></span><br><span class="line">     <span class="hljs-keyword">constraint</span> test2_uk <span class="hljs-keyword">unique</span>(test_pass)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>上面的建表语句为test_name、test_pass 分别建立了唯一约束， 这意味着这两列都不能出现重复值。除此之外，还可以为这两列组合建立唯一约束。<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#建表时创建唯一约束，使用表级约束语法建立约束</span></span><br><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> unique_test3</span><br><span class="line">(</span><br><span class="line"><span class="hljs-comment">#建立了非空约束，这意味着test_id不可以为null</span></span><br><span class="line">test_id <span class="hljs-built_in">int</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span>,</span><br><span class="line">test_name <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>) ,</span><br><span class="line">test_pass <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>)，</span><br><span class="line"><span class="hljs-comment">#使用表级约束语法建立唯一约束，指定两列组合不允许重复</span></span><br><span class="line"><span class="hljs-keyword">constraint</span> test3_uk <span class="hljs-keyword">unique</span>(test_name,test_pass)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>对于上面的unique_test2 和unique_test3两个表,都是对test_ name、test_pass建立唯一约束，其中unique_test2要求test_ name、test_pass都不能出现重复值，而unique_test3只要求test_name、test_pass两列值的组合不能重复。</p>
<p>也可以在修改表结构时使用add关键字来增加唯一约束<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#增加唯一约束</span></span><br><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> unique_test3</span><br><span class="line"><span class="hljs-keyword">add</span> <span class="hljs-keyword">unique</span> (test_name, test_pass) ;</span><br></pre></td></tr></table></figure></p>
<p>还可以在修改表时使用modify关键字，为单列采用列级约束语法来增加唯一约束:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#为unique_test3表的test_name列增加唯约束</span></span><br><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> unique_test3</span><br><span class="line"><span class="hljs-keyword">modify</span> <span class="hljs-keyword">test</span> <span class="hljs-keyword">name</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">unique</span>;</span><br></pre></td></tr></table></figure></p>
<p>对于大部分数据库而言,删除约束都是在alter table语句后使用<code>drop constraint约束名</code>语法来完成的，但MySQL并不使用这种方式，而是使用“drop index约束名”的方式来删除约束。例如如下SQL语句:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#删除unique_test3表上的test3_uk唯约束</span></span><br><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> unique_test3</span><br><span class="line"><span class="hljs-keyword">drop</span> <span class="hljs-keyword">index</span> test3_uk;</span><br></pre></td></tr></table></figure></p>
<h5 id="PRIMARY-KEY约束"><a href="#PRIMARY-KEY约束" class="headerlink" title="PRIMARY KEY约束"></a>PRIMARY KEY约束</h5><p>主键约束相当于非空约束和唯一约束， 即主键约束的列既不允许出现重复值，也不允许出现null值;如果对多列组合建立主键约束,则多列里包含的每一列都不能为空，但只要求这些列组合不能重复。主键列的值可用于唯一地标识表中的一条记录。</p>
<p>每一个表中<strong>最多允许有一个主键</strong>,但这个主键约束可由多个数据列组合而成，主键是表中能唯一确定一行记录的字段或字段组合。</p>
<p>建立主键约束时既可使用列级约束语法，也可使用表级约束语法。如果需要对多个字段建立组合主键约束，则只能使用表级约束语法。使用表级约束语法来建立约束时，可以为该约束指定约束名。但不管用户是否为该主键约束指定约束名，MySQL总是将所有的主键约束命名为PRIMARY。</p>
<p>建表时创建主键约束，使用列级约束语法:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> primary_ <span class="hljs-keyword">test</span></span><br><span class="line">(</span><br><span class="line">    <span class="hljs-comment">#建立了主键约束</span></span><br><span class="line">    <span class="hljs-keyword">test</span> <span class="hljs-keyword">id</span> <span class="hljs-built_in">int</span> primary <span class="hljs-keyword">key</span>,</span><br><span class="line">    test_ <span class="hljs-keyword">name</span> <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>建表时创建主键约束，使用表级约束语法:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> primary_test2</span><br><span class="line">(</span><br><span class="line">    test_id <span class="hljs-built_in">int</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span>,</span><br><span class="line">    test_name <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>) ,</span><br><span class="line">    test_pass <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>) ,</span><br><span class="line">    <span class="hljs-comment">#井指定主键约束名为test2_pk,对大部分数据库有效,但对MySQL无效     #MySQL数据库中该主键约束名依然是PRIMARY</span></span><br><span class="line">    <span class="hljs-keyword">constraint</span> test2_pk primary <span class="hljs-keyword">key</span>(test_id) </span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>建表时创建主键约束，以多列建立组合主键，只能使用表级约束语法:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> primary_test3</span><br><span class="line">（</span><br><span class="line">    test_name <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>)，</span><br><span class="line">    test_pass <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>) ,</span><br><span class="line">    并建立多列组合的主键约束</span><br><span class="line">    primary <span class="hljs-keyword">key</span>(test_name, test_pass)</span><br><span class="line"> );</span><br></pre></td></tr></table></figure></p>
<p>如果需要删除指定表的主键约束,则在alter table 语句后使用drop primary key子句即可。SQL语如下:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#删除主键约束</span></span><br><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> primary test3</span><br><span class="line"><span class="hljs-keyword">drop</span> primary <span class="hljs-keyword">key</span>;</span><br></pre></td></tr></table></figure></p>
<p>如果需要为指定表增加主键约束，既可通过modify修改列定义来增加主键约束，这将采用列级约束语法来增加主键约束;也可通过add来增加主键约束，这将采用表级约束语法来增加主键约束。SQL语句如下:<br>普使用表级约束语法增加主键约束<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> primary_test3</span><br><span class="line"><span class="hljs-keyword">add</span> primary <span class="hljs-keyword">key</span>(test_name, test_pass);</span><br></pre></td></tr></table></figure></p>
<p>如果只是为单独的数据列增加主键约束,则可使用modify修改列定义来实现:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#使用列级约束语法增加主键约束</span></span><br><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> primary test3</span><br><span class="line"><span class="hljs-keyword">modify</span> <span class="hljs-keyword">test</span> <span class="hljs-keyword">name</span> <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>) primary <span class="hljs-keyword">key</span>;</span><br></pre></td></tr></table></figure></p>
<p>不要连续执行上面两条SQL语句，因为上面两条SQL语句都是为primary_test3增加主键约束，而同一个表里最多只能有一个主键约束，所以连续执行上面两条SQL语句肯定出现错误。为了避免这个问题，可以在成功执行了第一条增加主键约束的SQL语句之后，先将primary_test3里的主键约束删除后再执行第二条增加主键约束的SQL语句。</p>
<p>很多数据库对主键列都支持一种自增长的特性,如果某个数据列的类型是整型,而且该列作为主键列，则可指定该列具有自增长功能。指定自增长功能通常用于设置逻辑主键列,该列的值没有任何物理意义，仅仅用于标识每行记录。MySQL使用auto_increment来设置自增长.<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> primary_test4</span><br><span class="line">   <span class="hljs-comment">#建立主键约束，使用自增长</span></span><br><span class="line">   test_id <span class="hljs-built_in">int</span> auto_increment primary <span class="hljs-keyword">key</span>,</span><br><span class="line">   test_name <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>)，</span><br><span class="line">   test_pass <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>一旦指定了某列具有自增长特性，则向该表插入记录时可不为该列指定值,该列的值由数据库系统自动生成。</p>
<h5 id="FOREIGN-KEY-约束"><a href="#FOREIGN-KEY-约束" class="headerlink" title="FOREIGN KEY 约束"></a>FOREIGN KEY 约束</h5><p>外键约束主要用于保证一个或两个数据表之间的参照完整性,外键是构建于一个表的两个字段或者两个表的两个字段之间的参照关系。外键确保了相关的两个字段的参照关系:子(从)表外键列的值必须在主表被参照列的值范围之内，或者为空(也可以通过非空约束来约束外键列不允许为空)。</p>
<p>当主表的记录被从表记录参照时，主表记录不允许被删除，必须先把从表里参照该记录的所有记录全部删除后，才可以删除主表的该记录。还有一种方式,删除主表记录时级联删除从表中所有参照该记录的从表记录。</p>
<p>从表外键参照的只能是主表主键列或者唯一键列,这样才可保证从表记录可以准确定位到被参照的主表记录。同一个表内可以拥有多个外键。</p>
<p>建立外键约束时，MySQL也会为该列建立索引。</p>
<p>外键约束通常用于定义两个实体之间的一对多、一对一的关联关系。对于一对多的关联关系,通常在多的一端增加外键列，例如老师一学生(假设一个老师对应多个学生，但每个学生只有一个老师,这是典型的一对多的关联关系)。为了建立他们之间的关联关系，可以在学生表中增加一个外键列，该列中保存此条学生记录对应老师的主键。对于一对一的关联关系，则可选择任意一方来增加外键列,增加外键列的表被称为从表,只要为外键列增加唯一约束就可表示一对一的关联关系了。对于多对多的关联关系，则需要额外增加一个连接表来记录它们的关联关系。</p>
<p>建立外键约束同样可以采用列级约束语法和表级约束语法。如果仅对单独的数据列建立外键约束，则使用列级约束语法即可;如果需要对多列组合创建外键约束，或者需要为外键约束指定名字,则必须使用表级约束语法。</p>
<p>采用列级约束语法建立外键约束直接使用references关键字, references 指定该列参照哪个主表，以及参照主表的哪一列。<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#为了保证从表参照的主表存在，通常应该先建主表</span></span><br><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> teacher_table</span><br><span class="line">(</span><br><span class="line">    <span class="hljs-comment">#auto_increment: 代表数据库的自动编号策略，通常用作数据表的      逻辑主键</span></span><br><span class="line">    teacher_id <span class="hljs-built_in">int</span> auto_increment,</span><br><span class="line">    teacher_name <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>),</span><br><span class="line">    primary_key(teacher_id)</span><br><span class="line">);</span><br><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> student_table(</span><br><span class="line"><span class="hljs-comment">#为本表建立主键约束</span></span><br><span class="line">student_id <span class="hljs-built_in">int</span> auto_increment primary <span class="hljs-keyword">key</span>,</span><br><span class="line">student_name <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>)，</span><br><span class="line"><span class="hljs-comment">#指定java_teacher参照到teacher_table的teacher_id列</span></span><br><span class="line">java_teacher <span class="hljs-built_in">int</span> <span class="hljs-keyword">references</span> teacher_table (teacher <span class="hljs-keyword">id</span>));</span><br></pre></td></tr></table></figure></p>
<p>值得指出的是，虽然MySQL支持使用列级约束语法来建立外键约束,但这种列级约束语法建立的外键约束不会生效，MySQL提供这种列级约束语法仅仅是为了和标准SQL保持良好的兼容性。因此，如果要使MySQL中的外键约束生效，则应使用表级约束语法。</p>
<figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#为了保证从表参照的主表存在，通常应该先建主表</span></span><br><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> teacher_tablel</span><br><span class="line">(</span><br><span class="line"><span class="hljs-comment">#auto_increment:代表数据库的自动编号策略，通常用作数据表的逻辑主键</span></span><br><span class="line">    teacher_id <span class="hljs-built_in">int</span> auto_increment,</span><br><span class="line">    teacher_name <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>),</span><br><span class="line">    primary <span class="hljs-keyword">key</span> (teacher_id)</span><br><span class="line">);</span><br><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> student_table1</span><br><span class="line">(</span><br><span class="line">    <span class="hljs-comment">#为本表建立主键约束</span></span><br><span class="line">    student_id <span class="hljs-built_in">int</span> auto_increment primary <span class="hljs-keyword">key</span>,</span><br><span class="line">    student_name <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>)，</span><br><span class="line">    <span class="hljs-comment">#指定java_teacher参照到teacher_tablel的teacher_id列</span></span><br><span class="line">    java_teacher <span class="hljs-built_in">int</span>,</span><br><span class="line">    <span class="hljs-keyword">foreign</span> <span class="hljs-keyword">key</span>(java_teacher) <span class="hljs-keyword">references</span> teacher_tablel     (teacher_id));</span><br></pre></td></tr></table></figure>
<p>如果使用表级约束语法，则需要使用foreige key来指定本表的外键列，并使用references来指定参照哪个主表，以及参照到主表的哪个数据列。使用表级约束语法可以为外键约束指定约束名,如果创建外键约束时没有指定约束名，则MySQL会为该外键约束命名为table_name_ibfk_n, 其中table_name 是从表的表名，而n是从1开始的整数。</p>
<p>如果需要显式指定外键约束的名字，则可使用constraint来指定名字。<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#为了保证从表参照的主表存在，通常应该先建主表</span></span><br><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> teacher_table2</span><br><span class="line"><span class="hljs-comment">#auto increment:代表数据库的自动编号策略，通常用作数据表的逻辑主键</span></span><br><span class="line">teacher_id <span class="hljs-built_in">int</span> auto_increment,</span><br><span class="line">teacher_name <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) ,</span><br><span class="line">primary <span class="hljs-keyword">key</span> (teacher_id)</span><br><span class="line">);</span><br><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> student_table2</span><br><span class="line"><span class="hljs-comment">#为本表建立主键约束</span></span><br><span class="line">student_id <span class="hljs-built_in">int</span> auto_increment primary <span class="hljs-keyword">key</span>,</span><br><span class="line">student_name <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>)，</span><br><span class="line">java_teacher <span class="hljs-built_in">int</span>,</span><br><span class="line"><span class="hljs-comment">#使用表级约束语法建立外键约束，指定外键约束的约束名为student_ teacher_fk</span></span><br><span class="line"><span class="hljs-keyword">constraint</span> student_teacher_fk <span class="hljs-keyword">foreign</span> <span class="hljs-keyword">key</span> (java_teacher) <span class="hljs-keyword">references</span> teacher_table2 (teacher_id));</span><br></pre></td></tr></table></figure></p>
<p>如果需要建立多列组合的外键约束，则必须使用表级约束语法，如下SQL语句所示:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#为了保证从表参照的主表存在，通常应该先建主表</span></span><br><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> teacher_table3</span><br><span class="line">(</span><br><span class="line">    teacher_name <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) ,</span><br><span class="line">    teacher_pass <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) ,</span><br><span class="line">    <span class="hljs-comment">#以两列建立组合主键</span></span><br><span class="line">    primary <span class="hljs-keyword">key</span>(teacher_name，teacher_pass)</span><br><span class="line">);</span><br><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> student_table3</span><br><span class="line"><span class="hljs-comment">#为本表建立主键约束</span></span><br><span class="line">student_id <span class="hljs-built_in">int</span> auto_increment primary <span class="hljs-keyword">key</span>,</span><br><span class="line">student_name <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>) ,</span><br><span class="line">java_teacher_name <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>) ,</span><br><span class="line">java_teacher_pass <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>) ,</span><br><span class="line"><span class="hljs-comment">#使用表级约束语法建立外键约束，指定两列的联合外键</span></span><br><span class="line"><span class="hljs-keyword">foreign</span> <span class="hljs-keyword">key</span>(java_teacher_name，java_teacher_pass)</span><br><span class="line"><span class="hljs-keyword">references</span> teacher_table3 (teacher_name，teacher_pass)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>删除外键约束的语法很简单，在alter table后增加“drop foreign key约束名”子句即可。如下代码所示:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#删除student_table3表上名为student_table3_ibfk_1的外键约束alter table student table3</span></span><br><span class="line"><span class="hljs-keyword">drop</span> <span class="hljs-keyword">foreign</span> <span class="hljs-keyword">key</span> student_table3_ibfk_1;</span><br></pre></td></tr></table></figure></p>
<p>增加外键约束通常使用add foreign key命令。如下SQL语句所示:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#修改student_table3数据表，增加外键约束</span></span><br><span class="line"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> student_table3</span><br><span class="line"><span class="hljs-keyword">add</span> <span class="hljs-keyword">foreign</span> <span class="hljs-keyword">key</span>(java_teacher_name，java_teacher_pass)</span><br><span class="line"><span class="hljs-keyword">references</span> teacher_table3 (teacher_name，teacher_pass);</span><br></pre></td></tr></table></figure></p>
<p>值得指出的是，外键约束不仅可以参照其他表，而且可以参照自身，这种参照自身的情况通常被称为<strong>自关联</strong>。例如，使用一个表保存某个公司的所有员工记录，员工之间有部门经理和普通员工之分，部门经理和普通员工之间存在一”对 多的关联关系，但他们都是保存在同一个数据表里的记录，这就是典型的自关联。下面的SQL语句用于建立自关联的外键约束。<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#使用表级约束语法建立外约束键，且直接参照自身</span></span><br><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> foreign_test</span><br><span class="line">foreign_id <span class="hljs-built_in">int</span> <span class="hljs-keyword">auto</span> <span class="hljs-keyword">increment</span> primary <span class="hljs-keyword">key</span>,</span><br><span class="line">foreign_name <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>)，</span><br><span class="line"><span class="hljs-comment">#使用该表的refer_id参照到本表的foreign id列</span></span><br><span class="line">refer_id <span class="hljs-built_in">int</span>,</span><br><span class="line"><span class="hljs-keyword">foreign</span> <span class="hljs-keyword">key</span>(refer_id) <span class="hljs-keyword">references</span> foreign_test(foreign_id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>如果想定义当删除主表记录时，从表记录也会随之删除，则需要在建立外键约束后添加on delete cascade或添加on delete set null,第-种是删除主表记录时，把参照该主表记录的从表记录全部级联删除;第二种是指定当删除主表记录时，把参照该主表记录的从表记录的外键设为null。如下SQL语句所示:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#为了保证从表参照的主表存在，通常应该先建主表</span></span><br><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> teacher_table4</span><br><span class="line">(</span><br><span class="line">    <span class="hljs-comment"># auto_increment:代表数据库的自动编号策略，通常用作数据表的逻辑主键</span></span><br><span class="line">    teacher_id <span class="hljs-built_in">int</span> auto_increment,</span><br><span class="line">    teacher_name <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>)，</span><br><span class="line">    primary <span class="hljs-keyword">key</span>(teacher_id)</span><br><span class="line">    );</span><br><span class="line">    <span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> student_table4</span><br><span class="line">    <span class="hljs-comment">#为本表建立主键约束</span></span><br><span class="line">    student_id <span class="hljs-built_in">int</span> auto_increment primary <span class="hljs-keyword">key</span>,</span><br><span class="line">    student_name <span class="hljs-built_in">varchar</span> (<span class="hljs-number">255</span>)，</span><br><span class="line">    java_teacher <span class="hljs-built_in">int</span>,</span><br><span class="line">    <span class="hljs-comment">#使用表级约束语法建立外键约束，定义级联删除</span></span><br><span class="line">    <span class="hljs-keyword">foreign</span> <span class="hljs-keyword">key</span>(java_teacher) <span class="hljs-keyword">references</span> teacher_table4     (teacher <span class="hljs-keyword">id</span>) <span class="hljs-keyword">on</span> <span class="hljs-keyword">delete</span> <span class="hljs-keyword">cascade</span></span><br><span class="line">    <span class="hljs-comment">#也可用on delete set null</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<h5 id="CHECK-约束"><a href="#CHECK-约束" class="headerlink" title="CHECK 约束"></a>CHECK 约束</h5><p>当前版本的MySQL支持建表时指定CHECK约束,但这个CHECK约束不会有任何作用。建立CHECK约束的语法很简单，只要在建表的列定义后增加check(逻辑表达式)即可。如下SQL语句所示:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> check_test</span><br><span class="line">   emp_id <span class="hljs-built_in">int</span> auto_increment,</span><br><span class="line">   emp_name <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>),</span><br><span class="line">   emp_salary <span class="hljs-built_in">decimal</span>,</span><br><span class="line">   primary <span class="hljs-keyword">key</span>(emp_id) ，</span><br><span class="line">   <span class="hljs-comment">#普建立CHECK约束</span></span><br><span class="line">   <span class="hljs-keyword">check</span> (emp_salary&gt;<span class="hljs-number">0</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>虽然上面的SQL语句建立的check_test表中有CHECK约束, CHECK约束要求emp_salary大于0,但这个要求实际上并不会起作用。</p>
<h4 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h4><p>索引是存放在模式(schema)中的一个数据库对象，虽然索引总是从属于数据表，但它也和数据表一样属于数据库对象。创建索引的唯一作用就是加速对表的查询,索引通过使用快速路径访问方法来快速定位数据，从而减少了磁盘的I/O。索引作为数据库对象，在数据字典中独立存放，但不能独立存在，必须属于某个表。MySQL使用information_schema数据库里的STATISTICS表来保存该数据库实例中的所有索引信息，用户可通过查询该表来获取该数据库的索引信息。</p>
<p>创建索引有两种方式。</p>
<ul>
<li>自动:当在表上定义主键约束、唯一约束和外键约束时，系统会为该数据列自动创建对应的索引。</li>
<li>手动:用户可以通过create index…语句来创建索引。</li>
</ul>
<p>删除索引也有两种方式。</p>
<ul>
<li>自动:数据表被删除时，该表上的索引自动被删除。</li>
<li>手动:用户可以通过drop index…语句来删除指定数据表上的指定索引。</li>
</ul>
<p>索引的作用类似于书的目录，几乎没有一本书没有目录，因此几乎没有一个表没有索引。一个表中可以有多个索引列，每个索引都可用于加速该列的查询速度。</p>
<p>正如书的目录总是根据书的知识点来建立一样因为读者经常要根据知识点来查阅一本书。类似的, 通常为经常需要查询的数据列建立索引，可以在一列或者多列上创建索引。创建索引的语法格式如下:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">index</span> index_name</span><br><span class="line"><span class="hljs-keyword">on</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">name</span>(<span class="hljs-keyword">column</span>[, <span class="hljs-keyword">column</span>]...);</span><br></pre></td></tr></table></figure></p>
<p>下面的索引将会提高对employees表基于last_name字段的查询速度。<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">index</span> emp_last_name_idx</span><br><span class="line"><span class="hljs-keyword">on</span> employees(<span class="hljs-number">1</span>ast_name) ;</span><br></pre></td></tr></table></figure></p>
<p>也可同时对多列建立索引，如下SQL语句所示:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#下面语句为employees的first_name和last_name两列同时建立索引</span></span><br><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">index</span> emp_last_name_idx2</span><br><span class="line"><span class="hljs-keyword">on</span> employees (first_name, last_name);</span><br></pre></td></tr></table></figure></p>
<p>MySQL中删除索引需要指定表，采用如下语法格式:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">drop</span> <span class="hljs-keyword">index</span>索引名<span class="hljs-keyword">on</span>表名</span><br></pre></td></tr></table></figure></p>
<p>如下SQL语句删除了employees表上的emp_last_name_idx2索引:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">drop</span> <span class="hljs-keyword">index</span> emp_last_name_idx2</span><br><span class="line"><span class="hljs-keyword">on</span> employees</span><br></pre></td></tr></table></figure></p>
<p>有些数据库删除索引时无须指定表名,因为它们要求建立索引时每个索引都有唯一的名字, 所以无须指定表名，例如Oracle就采用这种策略。但MySQL只要求同一个表内的索引不能同名，所以删除索引时必须指定表名。索引的好处是可以加速查询。但索引也有如下两个坏处。</p>
<ul>
<li>与书的目录类似，当数据表中的记录被添加、删除、修改时，数据库系统需要维护索引，因此有一定的系统开销。</li>
<li>存储索引信息需要-一定的磁盘空间。</li>
</ul>
<h4 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h4><p>视图看上去非常像一个数据表，但它不是数据表，因为它并不能存储数据。视图只是一个或多个数据表中数据的逻辑显示。使用视图有如下几个好处。</p>
<ul>
<li>可以限制对数据的访问。</li>
<li>可以使复杂的查询变得简单。</li>
<li>提供了数据的独立性。</li>
<li>提供了对相同数据的不同显示。<br>因为视图只是数据表中数据的逻辑显示————也就是一个查询结果,所以创建视图就是建立视图名和查询语句的关联。创建视图的语法如下:<figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">replace</span> <span class="hljs-keyword">view</span>视图名</span><br><span class="line"><span class="hljs-keyword">as</span></span><br><span class="line">subquery</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>从上面的语法可以看出，创建、修改视图都可使用上面语法。上面语法的含义是,如果该视图不存在，则创建视图;如果指定视图名的视图已经存在，则使用新视图替换原有视图。后面的subquery就是一个查询语句，这个查询可以非常复杂。<br>通过建立视图的语法规则不难看出，所谓视图的本质，其实就是一条被命名的SQL查询语句。</p>
<p>一旦建立了视图以后，使用该视图与使用数据表就没有什么区别了，但通常只是查询视图数据,不会修改视图里的数据，因为视图本身没有存储数据。<br>如下SQL语句就创建了一个简单的视图:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">replace</span> <span class="hljs-keyword">view</span> view_test</span><br><span class="line"><span class="hljs-keyword">as</span></span><br><span class="line"><span class="hljs-keyword">select</span> teacher_name，teacher_pass <span class="hljs-keyword">from</span> teacher_table;</span><br></pre></td></tr></table></figure></p>
<p>通常不推荐直接改变视图的数据,因为视图并不存储数据,它只是相当于一条命名的查询语句而已。为了强制不允许改变视图的数据，MySQL 允许在创建视图时使用with check option 子句，使用该子句创建的视图不允许修改，如下所示:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">replace</span> <span class="hljs-keyword">view</span> view_test</span><br><span class="line"><span class="hljs-keyword">as</span></span><br><span class="line"><span class="hljs-keyword">select</span> teacher_name <span class="hljs-keyword">from</span> teacher_table</span><br><span class="line"><span class="hljs-comment">#指定不允许修改该视图的数据</span></span><br><span class="line"><span class="hljs-keyword">with</span> <span class="hljs-keyword">check</span> <span class="hljs-keyword">option</span>;</span><br></pre></td></tr></table></figure></p>
<p>大部分数据库都采用with check option来强制不允许修改视图的数据，但Oracle采用with read only来强制不允许修改视图的数据.</p>
<p>删除视图使用如下语句:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">drop</span> <span class="hljs-keyword">view</span> 视图名</span><br></pre></td></tr></table></figure></p>
<p>如下SQL语句删除了前面刚刚创建的视图:<br><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">drop</span> <span class="hljs-keyword">view</span> view_test;</span><br></pre></td></tr></table></figure></p>

        </div>
        
        
        
    </div>
</div>








</div>
                




<div class="column is-4-tablet is-4-desktop is-4-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    <img class="image is-128x128 has-mb-6" src="http://plmk8ppkc.bkt.clouddn.com/IMG_2113.JPG" alt="HuKai">
                    
                    <p class="is-size-4 is-block">
                        HuKai
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Java Developer
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Suzhou,China</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <p class="title has-text-weight-normal">
                        3
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <p class="title has-text-weight-normal">
                        0
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <p class="title has-text-weight-normal">
                        3
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="http://github.com/iceco1a">
                Follow</a>
        </div>
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Github" href="http://github.com/iceco1a">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Facebook" href="http://facebook.com">
                
                <i class="fab fa-facebook"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Twitter" href="http://twitter.com">
                
                <i class="fab fa-twitter"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Dribbble" href="http://dribbble.com">
                
                <i class="fab fa-dribbble"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="RSS" href="/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        

<div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Links
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://hexo.io" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Hexo</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">hexo.io</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://github.com/iceco1a" target="_blank">
                    <span class="level-left">
                        <span class="level-item">PPOffice</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>


    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            
            </ul>
        </div>
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/Database/" style="font-size: 10px;">Database</a> <a href="/tags/Java/" style="font-size: 10px;">Java</a> <a href="/tags/MySQL/" style="font-size: 10px;">MySQL</a>
    </div>
</div>

    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2019/01/24/MySQL基础/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="MySQL基础">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-01-23T16:00:00.000Z">2019-01-24</time></div>
                    <a href="/2019/01/24/MySQL基础/" class="has-link-black-ter is-size-6">MySQL基础</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/01/23/Java IO/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/leimu.jpeg" alt="Java IO流">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-01-22T16:00:00.000Z">2019-01-23</time></div>
                    <a href="/2019/01/23/Java IO/" class="has-link-black-ter is-size-6">Java IO流</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/01/18/hello-world/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Hello World">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-01-18T09:00:43.863Z">2019-01-18</time></div>
                    <a href="/2019/01/18/hello-world/" class="has-link-black-ter is-size-6">Hello World</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/01/">
                <span class="level-start">
                    <span class="level-item">January 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Tags
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Database/">
                        <span class="tag">Database</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Java/">
                        <span class="tag">Java</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MySQL/">
                        <span class="tag">MySQL</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
        </div>
    
</div>

                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.svg" alt="iceco1a" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2019 iceco1a&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-icarus">Icarus</a>
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Download on GitHub" href="http://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {matchFontHeight: false},
        SVG: {matchFontHeight: false},
        CommonHTML: {matchFontHeight: false}
    });
});
</script>

    
    

<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>